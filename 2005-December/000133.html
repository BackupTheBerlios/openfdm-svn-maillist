<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OpenFDM-svn] r149 - trunk/OpenFDM/src/OpenFDM
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openfdm-svn/2005-December/index.html" >
   <LINK REL="made" HREF="mailto:openfdm-svn%40lists.berlios.de?Subject=Re%3A%20%5BOpenFDM-svn%5D%20r149%20-%20trunk/OpenFDM/src/OpenFDM&In-Reply-To=%3C200512311131.jBVBVW0m030078%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000132.html">
   <LINK REL="Next"  HREF="000134.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OpenFDM-svn] r149 - trunk/OpenFDM/src/OpenFDM</H1>
    <B>frohlich at berlios.de</B> 
    <A HREF="mailto:openfdm-svn%40lists.berlios.de?Subject=Re%3A%20%5BOpenFDM-svn%5D%20r149%20-%20trunk/OpenFDM/src/OpenFDM&In-Reply-To=%3C200512311131.jBVBVW0m030078%40sheep.berlios.de%3E"
       TITLE="[OpenFDM-svn] r149 - trunk/OpenFDM/src/OpenFDM">frohlich at berlios.de
       </A><BR>
    <I>Sat Dec 31 12:31:32 CET 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000132.html">[OpenFDM-svn] r148 - trunk/OpenFDM/src/OpenFDM/LinAlg
</A></li>
        <LI>Next message: <A HREF="000134.html">[OpenFDM-svn] r150 - trunk/OpenFDM/src/OpenFDM
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#133">[ date ]</a>
              <a href="thread.html#133">[ thread ]</a>
              <a href="subject.html#133">[ subject ]</a>
              <a href="author.html#133">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: frohlich
Date: 2005-12-31 12:31:20 +0100 (Sat, 31 Dec 2005)
New Revision: 149

Modified:
   trunk/OpenFDM/src/OpenFDM/AeroForce.cpp
   trunk/OpenFDM/src/OpenFDM/AeroForce.h
Log:
Make those sensed values return const refs.


Modified: trunk/OpenFDM/src/OpenFDM/AeroForce.cpp
===================================================================
--- trunk/OpenFDM/src/OpenFDM/AeroForce.cpp	2005-12-31 11:02:37 UTC (rev 148)
+++ trunk/OpenFDM/src/OpenFDM/AeroForce.cpp	2005-12-31 11:31:20 UTC (rev 149)
@@ -151,7 +151,7 @@
   mWingSpan = winSpan;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getWingSpan(void) const
 {
   return mWingSpan;
@@ -163,7 +163,7 @@
   mWingArea = winArea;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getWingArea(void) const
 {
   return mWingArea;
@@ -175,7 +175,7 @@
   mCoord = coord;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getCoord(void) const
 {
   return mCoord;
@@ -237,7 +237,7 @@
   return mMach;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getTrueSpeed(void) const
 {
   if (mDirtyTrueSpeed) {
@@ -249,7 +249,7 @@
   return mTrueSpeed;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getEquivalentAirSpeed(void) const
 {
   if (mDirtyEquivalentAirSpeed)
@@ -259,7 +259,7 @@
   return mEquivalentAirSpeed;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getCalibratedAirSpeed(void) const
 {
   if (mDirtyCalibratedAirSpeed)
@@ -269,7 +269,7 @@
   return mCalibratedAirSpeed;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getDynamicPressure(void) const
 {
   if (mDirtyDynamicPressure) {
@@ -282,7 +282,7 @@
   return mDynamicPressure;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getAlpha(void) const
 {
   if (mDirtyAlpha) {
@@ -297,7 +297,7 @@
   return mAlpha;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getAlphaDot(void) const
 {
   if (mDirtyAlphaDot) {
@@ -315,7 +315,7 @@
   return mAlphaDot;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getBeta(void) const
 {
   if (mDirtyBeta) {
@@ -332,7 +332,7 @@
   return mBeta;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getBetaDot(void) const
 {
   if (mDirtyBetaDot) {
@@ -352,88 +352,112 @@
   return mBetaDot;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getBodyU(void) const
 {
   const Vector6&amp; speed = getAirSpeed();
   return speed(4);
 }
 
-real_type
+const real_type&amp;
 AeroForce::getBodyV(void) const
 {
   const Vector6&amp; speed = getAirSpeed();
   return speed(5);
 }
 
-real_type
+const real_type&amp;
 AeroForce::getBodyW(void) const
 {
   const Vector6&amp; speed = getAirSpeed();
   return speed(6);
 }
 
-real_type
+const real_type&amp;
 AeroForce::getBodyP(void) const
 {
   const Vector6&amp; speed = getAirSpeed();
   return speed(1);
 }
 
-real_type
+const real_type&amp;
 AeroForce::getBodyQ(void) const
 {
   const Vector6&amp; speed = getAirSpeed();
   return speed(2);
 }
 
-real_type
+const real_type&amp;
 AeroForce::getBodyR(void) const
 {
   const Vector6&amp; speed = getAirSpeed();
   return speed(3);
 }
 
-real_type
+const real_type&amp;
 AeroForce::getMachNumber(void) const
 {
-  return norm(getMach());
+  if (mDirtyMachNumber) {
+    mMachNumber = norm(getMach());
+    mDirtyMachNumber = false;
+  }
+  Log(ArtBody, Debug3) &lt;&lt; &quot;AeroForce::getMachNumber()&quot;
+                       &lt;&lt; mMachNumber &lt;&lt; endl;
+  return mMachNumber;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getTrueSpeedUW(void) const
 {
-  const Vector6&amp; speed = getAirSpeed();
-  return sqrt(speed(4)*speed(4)+speed(6)*speed(6));
+  if (mDirtyTrueSpeedUW) {
+    const Vector6&amp; speed = getAirSpeed();
+    mTrueSpeedUW = sqrt(speed(4)*speed(4)+speed(6)*speed(6));
+    mDirtyTrueSpeedUW = false;
+  }
+  Log(ArtBody, Debug3) &lt;&lt; &quot;AeroForce::getTrueSpeedUW()&quot;
+                       &lt;&lt; mTrueSpeedUW &lt;&lt; endl;
+  return mTrueSpeedUW;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getWingSpanOver2Speed(void) const
 {
-  real_type Vt2 = 2*getTrueSpeed();
-  if (fabs(Vt2) &lt; Limits&lt;real_type&gt;::min())
-    return 0;
-  else
-    return getWingSpan()/Vt2;
+  if (mDirtyWingSpanOver2Speed) {
+    real_type Vt2 = 2*getTrueSpeed();
+    if (fabs(Vt2) &lt; Limits&lt;real_type&gt;::min())
+      mWingSpanOver2Speed = 0;
+    else
+      mWingSpanOver2Speed = getWingSpan()/Vt2;
+    mDirtyWingSpanOver2Speed = false;
+  }
+  return mWingSpanOver2Speed;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getCoordOver2Speed(void) const
 {
-  real_type Vt2 = 2*getTrueSpeed();
-  if (fabs(Vt2) &lt; Limits&lt;real_type&gt;::min())
-    return 0;
-  else
-    return getCoord()/Vt2;
+  if (mDirtyCoordOver2Speed) {
+    real_type Vt2 = 2*getTrueSpeed();
+    if (fabs(Vt2) &lt; Limits&lt;real_type&gt;::min())
+      mCoordOver2Speed = 0;
+    else
+      mCoordOver2Speed = getCoord()/Vt2;
+    mDirtyCoordOver2Speed = false;
+  }
+  return mCoordOver2Speed;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getHOverWingSpan(void) const
 {
-  return getAboveGroundLevel()/getWingSpan();
+  if (mDirtyHOverWingSpan) {
+    mHOverWingSpan = getAboveGroundLevel()/getWingSpan();
+    mDirtyHOverWingSpan = false;
+  }
+  return mHOverWingSpan;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getAltitude(void) const
 {
   if (mDirtyAltitude) {
@@ -452,7 +476,7 @@
   return mAltitude;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getAboveGroundLevel(void) const
 {
   if (mDirtyAboveGroundLevel) {
@@ -473,7 +497,7 @@
   return mAboveGroundLevel;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getPressure(void) const
 {
   computeAtmosphere();
@@ -482,7 +506,7 @@
   return mAtmos.pressure;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getDensity(void) const
 {
   computeAtmosphere();
@@ -491,7 +515,7 @@
   return mAtmos.density;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getSoundSpeed(void) const
 {
   computeAtmosphere();
@@ -500,7 +524,7 @@
   return mAtmos.soundspeed;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getTemperature(void) const
 {
   computeAtmosphere();
@@ -509,28 +533,28 @@
   return mAtmos.temperature;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getPressureSeaLevel(void) const
 {
   computeSLAtmosphere();
   return mSLAtmos.pressure;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getDensitySeaLevel(void) const
 {
   computeSLAtmosphere();
   return mSLAtmos.density;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getSoundSpeedSeaLevel(void) const
 {
   computeSLAtmosphere();
   return mSLAtmos.soundspeed;
 }
 
-real_type
+const real_type&amp;
 AeroForce::getTemperatureSeaLevel(void) const
 {
   computeSLAtmosphere();
@@ -610,10 +634,15 @@
   mDirtyAtmosphere = true;
   mDirtyAltitude = true;
   mDirtyAboveGroundLevel = true;
+  mDirtyWingSpanOver2Speed = true;
+  mDirtyCoordOver2Speed = true;
+  mDirtyHOverWingSpan = true;
   mDirtySLAtmosphere = true;
   mDirtyAirSpeed = true;
   mDirtyMach = true;
+  mDirtyMachNumber = true;
   mDirtyTrueSpeed = true;
+  mDirtyTrueSpeedUW = true;
   mDirtyCalibratedAirSpeed = true;
   mDirtyEquivalentAirSpeed = true;
   mDirtyDynamicPressure = true;

Modified: trunk/OpenFDM/src/OpenFDM/AeroForce.h
===================================================================
--- trunk/OpenFDM/src/OpenFDM/AeroForce.h	2005-12-31 11:02:37 UTC (rev 148)
+++ trunk/OpenFDM/src/OpenFDM/AeroForce.h	2005-12-31 11:31:20 UTC (rev 149)
@@ -43,57 +43,57 @@
   const Rotation&amp; getOrientation(void) const;
 
   void setWingSpan(const real_type&amp; winSpan);
-  real_type getWingSpan(void) const;
+  const real_type&amp; getWingSpan(void) const;
 
   void setWingArea(const real_type&amp; winArea);
-  real_type getWingArea(void) const;
+  const real_type&amp; getWingArea(void) const;
 
   void setCoord(const real_type&amp; coord);
-  real_type getCoord(void) const;
+  const real_type&amp; getCoord(void) const;
 
   const Vector3&amp; getRefPosition(void) const;
   const Vector6&amp; getAirSpeed(void) const;
   const Vector3&amp; getMach(void) const;
-  real_type getTrueSpeed(void) const;
-  real_type getEquivalentAirSpeed(void) const;
-  real_type getCalibratedAirSpeed(void) const;
-  real_type getDynamicPressure(void) const;
-  real_type getAlpha(void) const;
-  real_type getAlphaDot(void) const;
-  real_type getBeta(void) const;
-  real_type getBetaDot(void) const;
+  const real_type&amp; getTrueSpeed(void) const;
+  const real_type&amp; getEquivalentAirSpeed(void) const;
+  const real_type&amp; getCalibratedAirSpeed(void) const;
+  const real_type&amp; getDynamicPressure(void) const;
+  const real_type&amp; getAlpha(void) const;
+  const real_type&amp; getAlphaDot(void) const;
+  const real_type&amp; getBeta(void) const;
+  const real_type&amp; getBetaDot(void) const;
 
-  real_type getBodyU(void) const;
-  real_type getBodyV(void) const;
-  real_type getBodyW(void) const;
+  const real_type&amp; getBodyU(void) const;
+  const real_type&amp; getBodyV(void) const;
+  const real_type&amp; getBodyW(void) const;
 
-  real_type getBodyP(void) const;
-  real_type getBodyQ(void) const;
-  real_type getBodyR(void) const;
+  const real_type&amp; getBodyP(void) const;
+  const real_type&amp; getBodyQ(void) const;
+  const real_type&amp; getBodyR(void) const;
 
-  real_type getMachNumber(void) const;
-  real_type getTrueSpeedUW(void) const;
+  const real_type&amp; getMachNumber(void) const;
+  const real_type&amp; getTrueSpeedUW(void) const;
 
   /// FIXME, may be just provide 1/(2Vt)???
   /// Or provide the whole set of nondimentionalized values ...
   /// May be better since we can throw out the singularities ...
-  real_type getWingSpanOver2Speed(void) const;
-  real_type getCoordOver2Speed(void) const;
-  real_type getHOverWingSpan(void) const;
+  const real_type&amp; getWingSpanOver2Speed(void) const;
+  const real_type&amp; getCoordOver2Speed(void) const;
+  const real_type&amp; getHOverWingSpan(void) const;
 
-  real_type getAltitude(void) const;
-  real_type getAboveGroundLevel(void) const;
+  const real_type&amp; getAltitude(void) const;
+  const real_type&amp; getAboveGroundLevel(void) const;
 
-  real_type getPressure(void) const;
-  real_type getDensity(void) const;
-  real_type getSoundSpeed(void) const;
-  real_type getTemperature(void) const;
+  const real_type&amp; getPressure(void) const;
+  const real_type&amp; getDensity(void) const;
+  const real_type&amp; getSoundSpeed(void) const;
+  const real_type&amp; getTemperature(void) const;
 
 
-  real_type getPressureSeaLevel(void) const;
-  real_type getDensitySeaLevel(void) const;
-  real_type getSoundSpeedSeaLevel(void) const;
-  real_type getTemperatureSeaLevel(void) const;
+  const real_type&amp; getPressureSeaLevel(void) const;
+  const real_type&amp; getDensitySeaLevel(void) const;
+  const real_type&amp; getSoundSpeedSeaLevel(void) const;
+  const real_type&amp; getTemperatureSeaLevel(void) const;
 
   const Vector3&amp; getUnitDown(void) const;
   const Plane&amp; getLocalGroundPlane(void) const;
@@ -146,11 +146,16 @@
   mutable bool mDirtyLocalGroundPlane:1;
   mutable bool mDirtyAltitude:1;
   mutable bool mDirtyAboveGroundLevel:1;
+  mutable bool mDirtyWingSpanOver2Speed:1;
+  mutable bool mDirtyCoordOver2Speed:1;
+  mutable bool mDirtyHOverWingSpan:1;
   mutable bool mDirtyAtmosphere:1;
   mutable bool mDirtySLAtmosphere:1;
   mutable bool mDirtyAirSpeed:1;
   mutable bool mDirtyMach:1;
+  mutable bool mDirtyMachNumber:1;
   mutable bool mDirtyTrueSpeed:1;
+  mutable bool mDirtyTrueSpeedUW:1;
   mutable bool mDirtyCalibratedAirSpeed:1;
   mutable bool mDirtyEquivalentAirSpeed:1;
   mutable bool mDirtyDynamicPressure:1;
@@ -165,9 +170,14 @@
   mutable AtmosphereData mSLAtmos;
   mutable Vector6 mAirSpeed;
   mutable Vector3 mMach;
+  mutable real_type mMachNumber;
   mutable real_type mAltitude;
   mutable real_type mAboveGroundLevel;
+  mutable real_type mWingSpanOver2Speed;
+  mutable real_type mCoordOver2Speed;
+  mutable real_type mHOverWingSpan;
   mutable real_type mTrueSpeed;
+  mutable real_type mTrueSpeedUW;
   mutable real_type mCalibratedAirSpeed;
   mutable real_type mEquivalentAirSpeed;
   mutable real_type mDynamicPressure;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000132.html">[OpenFDM-svn] r148 - trunk/OpenFDM/src/OpenFDM/LinAlg
</A></li>
	<LI>Next message: <A HREF="000134.html">[OpenFDM-svn] r150 - trunk/OpenFDM/src/OpenFDM
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#133">[ date ]</a>
              <a href="thread.html#133">[ thread ]</a>
              <a href="subject.html#133">[ subject ]</a>
              <a href="author.html#133">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openfdm-svn">More information about the OpenFDM-svn
mailing list</a><br>
</body></html>
